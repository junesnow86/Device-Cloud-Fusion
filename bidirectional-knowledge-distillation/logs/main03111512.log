(oppo) (base) ljt@sandbox-ljt:~/Device-Cloud-Fusion/mutual-distillation$ python main.py 
Files already downloaded and verified
Files already downloaded and verified
>>> Start training cloud model...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:16<00:00, 19.37it/s]
Epoch 1: Loss = 0.8240184179319742
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.76it/s]
Epoch 2: Loss = 0.5793680979040103
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.81it/s]
Epoch 3: Loss = 0.49230743411440436
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.78it/s]
Epoch 4: Loss = 0.449404724965842
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.78it/s]
Epoch 5: Loss = 0.40048492592744556
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.79it/s]
Epoch 6: Loss = 0.3559844513861135
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.72it/s]
Epoch 7: Loss = 0.31836044264677615
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.78it/s]
Epoch 8: Loss = 0.30818179236671417
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.78it/s]
Epoch 9: Loss = 0.2528387275390541
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.66it/s]
Epoch 10: Loss = 0.2358105435086706
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.69it/s]
Epoch 11: Loss = 0.2185757936070712
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.70it/s]
Epoch 12: Loss = 0.20795004090038352
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:16<00:00, 19.54it/s]
Epoch 13: Loss = 0.1812139690939944
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.64it/s]
Epoch 14: Loss = 0.15667679674399737
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.61it/s]
Epoch 15: Loss = 0.16034602623182936
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.70it/s]
Epoch 16: Loss = 0.1366982553689815
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.63it/s]
Epoch 17: Loss = 0.1429333030662764
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.62it/s]
Epoch 18: Loss = 0.1227862956456114
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.64it/s]
Epoch 19: Loss = 0.11213920880763675
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 313/313 [00:15<00:00, 19.68it/s]
Epoch 20: Loss = 0.10831507344316608
>>> Start training party A model...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.59it/s]
Epoch 1: Loss = 1.2414057814598083
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 126.77it/s]
Epoch 2: Loss = 1.088417150592804
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 126.51it/s]
Epoch 3: Loss = 0.9849065565109253
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.14it/s]
Epoch 4: Loss = 0.8965140731811524
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 128.03it/s]
Epoch 5: Loss = 0.7969129674911499
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.81it/s]
Epoch 6: Loss = 0.7043443232059479
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.99it/s]
Epoch 7: Loss = 0.6037664590120315
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.68it/s]
Epoch 8: Loss = 0.5151548650503158
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.59it/s]
Epoch 9: Loss = 0.4246838085055351
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 128.44it/s]
Epoch 10: Loss = 0.3661307255625725
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.56it/s]
Epoch 11: Loss = 0.30614763585925103
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.22it/s]
Epoch 12: Loss = 0.2736227212548256
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 128.02it/s]
Epoch 13: Loss = 0.22673295430541038
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 128.19it/s]
Epoch 14: Loss = 0.19317601819932462
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 126.98it/s]
Epoch 15: Loss = 0.16851133883595468
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.92it/s]
Epoch 16: Loss = 0.16772513900101185
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.27it/s]
Epoch 17: Loss = 0.13582603031545878
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.86it/s]
Epoch 18: Loss = 0.10963168242424727
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.31it/s]
Epoch 19: Loss = 0.10206959644891321
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:04<00:00, 127.32it/s]
Epoch 20: Loss = 0.10242024714276195
>>> Start training party B model...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 101.56it/s]
Epoch 1: Loss = 1.1225496459007263
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.77it/s]
Epoch 2: Loss = 0.8424283201217652
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.93it/s]
Epoch 3: Loss = 0.7154736031532287
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 103.23it/s]
Epoch 4: Loss = 0.6453318575382233
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.94it/s]
Epoch 5: Loss = 0.5957019032478332
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.98it/s]
Epoch 6: Loss = 0.5523575674057006
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.77it/s]
Epoch 7: Loss = 0.5220699860095978
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.95it/s]
Epoch 8: Loss = 0.4765237650871277
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 101.45it/s]
Epoch 9: Loss = 0.4443155134439468
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.69it/s]
Epoch 10: Loss = 0.4252599478363991
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 103.10it/s]
Epoch 11: Loss = 0.3955226331233978
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.70it/s]
Epoch 12: Loss = 0.3783707102537155
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.69it/s]
Epoch 13: Loss = 0.34600385497808456
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.98it/s]
Epoch 14: Loss = 0.34087956821918486
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.53it/s]
Epoch 15: Loss = 0.31376486241817475
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.85it/s]
Epoch 16: Loss = 0.3087841304183006
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 103.01it/s]
Epoch 17: Loss = 0.29146473328471184
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 102.27it/s]
Epoch 18: Loss = 0.2761433643639088
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 100.98it/s]
Epoch 19: Loss = 0.25800342701673507
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:06<00:00, 101.48it/s]
Epoch 20: Loss = 0.2433905140787363
>>> Start distillation from party A to cloud...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.07it/s]
Epoch 1: Loss = 8.415599015808105
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.17it/s]
Epoch 2: Loss = 6.965406499481201
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.11it/s]
Epoch 3: Loss = 6.490954779052735
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.09it/s]
Epoch 4: Loss = 7.00125922088623
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.10it/s]
Epoch 5: Loss = 6.455059461212159
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.11it/s]
Epoch 6: Loss = 7.7056099182128905
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.08it/s]
Epoch 7: Loss = 8.021278568267823
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.09it/s]
Epoch 8: Loss = 7.6610194480896
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.10it/s]
Epoch 9: Loss = 7.979939617919922
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:34<00:00, 18.09it/s]
Epoch 10: Loss = 7.989566059112549
>>> Start distillation from party B to cloud...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.54it/s]
Epoch 1: Loss = 3.2986666511535643
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.57it/s]
Epoch 2: Loss = 2.5086260896682737
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.54it/s]
Epoch 3: Loss = 2.1173584325790404
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.52it/s]
Epoch 4: Loss = 1.9526705293655395
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.55it/s]
Epoch 5: Loss = 2.0943405663490293
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.52it/s]
Epoch 6: Loss = 1.935652319431305
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.52it/s]
Epoch 7: Loss = 1.7682332290649414
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.56it/s]
Epoch 8: Loss = 1.6089676064491272
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.52it/s]
Epoch 9: Loss = 1.5806858835220337
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 625/625 [00:35<00:00, 17.53it/s]
Cloud model accuracy: 0.1721
Party A model accuracy: 0.2489
Party B model accuracy: 0.3398
Cloud model accuracy after distillation from party A: 0.1465
Cloud model accuracy after distillation from party B: 0.2913

Comments:
模型：
- 云：ResNet152
- 设备：MobileNet-v3-small, MobileNet-v3-large

数据：
- 数据集：CIFAR-10
- 数据划分：将CIFAR-10的20%划分给云，80%划分给设备；设备的80%中再按5类-5类划分给两个设备。

使用设备数据进行了 设备->云 蒸馏，云模型在完成来自两个设备模型的蒸馏后，性能有提升。
但是迁移集选择不合理，迁移集选择了设备数据集，这样的话蒸馏过程就需要在设备上进行，而设备的计算能力有限，是不支持下载和运行云端模型的。
